<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mining the Latent Relationship among Variables using Mixture Model -- Supplementary Materials • RobMixReg</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Mining the Latent Relationship among Variables using Mixture Model -- Supplementary Materials">
<meta property="og:description" content="RobMixReg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RobMixReg</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/tutorial.html">Mining the Latent Relationship among Variables using Mixture Model -- Supplementary Materials</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/changwn/RobMixReg/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Mining the Latent Relationship among Variables using Mixture Model – Supplementary Materials</h1>
                        <h4 class="author">Wennan Chang</h4>
                        <h4 class="author">Chi Zhang*</h4>
                        <h4 class="author">Sha Cao*</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/changwn/RobMixReg/blob/master/vignettes/tutorial.Rmd"><code>vignettes/tutorial.Rmd</code></a></small>
      <div class="hidden name"><code>tutorial.Rmd</code></div>

    </div>

    
    
<div id="s1--introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#s1--introduction" class="anchor"></a>S1. Introduction</h2>
<p>Coming soon.</p>
</div>
<div id="s2--case-study" class="section level2">
<h2 class="hasAnchor">
<a href="#s2--case-study" class="anchor"></a>S2. Case Study</h2>
<div id="s2-0-preparation-install-the-robmixreg-pacakge" class="section level3">
<h3 class="hasAnchor">
<a href="#s2-0-preparation-install-the-robmixreg-pacakge" class="anchor"></a>S2.0 Preparation: Install the RobMixReg Pacakge</h3>
<p>The RobMixReg package publised on the CRAN. That means the package has better stability and easy to install on several platform (e.g. windows, linux) because CRAN has stricter requirement than github.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="co">#install.packages('RobMixReg')</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">RobMixReg</span>)</pre></body></html></div>
<p>The RobMixReg package also has the most updated version on github.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r">#library("devtools")
#devtools::install_github("changwn/RobMixReg")</pre></body></html></div>
</div>
<div id="s2-1-example-1-low-dimension-k1-with-outlier" class="section level3">
<h3 class="hasAnchor">
<a href="#s2-1-example-1-low-dimension-k1-with-outlier" class="anchor"></a>S2.1 Example 1: Low dimension, <span class="math inline">\(K=1\)</span> with outlier</h3>
<p>Linear regression is the classical model to explorer the relationship between two variables (e.g. gene and patient outcome). However, general linear model is very unstable when there are outliers caused by measurement error or patient internal heterogeneity. To deal with this problem, robust mixture regression became a common way during the statistic analysis (e,g. drug sensitivity prediction et al.). The example 1 simulate the situation which contains a single regression line and several outliers. The implemented algorithm is Least Trimmed Squares Robust Regression (see Table 1 in maintext).</p>
<ul>
<li>Mathmatical Model</li>
</ul>
<p><span class="math display">\[
\left\{ \begin{array}{rcl}
  y_i - \beta_1 x_i - \beta_0 - \epsilon \leq \eta &amp; \mbox{if} &amp; (x_i, y_i) \in regression \ line \\ 
  y_i - \beta_1 x_i - \beta_0 - \epsilon &gt; \eta &amp; \mbox{if} &amp; (x_i, y_i) \ is \ outlier \\
  \end{array}\right.
\]</span></p>
<div id="data-simulation" class="section level4">
<h4 class="hasAnchor">
<a href="#data-simulation" class="anchor"></a>Data Simulation:</h4>
<p>In this section, we introduce the data generation process. The goal of simulation is to generate single regression line and several outliers. The independent variable <em>gene</em> is a vector and its length is 300. <span class="math inline">\(gene \sim N(5,1)\)</span>.The coefficient is controled by variable <em>slope</em> and intercept is controled by variable <em>inter</em>. The generation of dependent variable consist of two steps. Firstly, generate a strict regression line based on formula <span class="math inline">\(y_i = \beta x_i + \beta_0\)</span>. Then, the Gaussian white noise, <span class="math inline">\(\epsilon \sim N(0,0.1^2)\)</span>,added to the line. Thus, the least square regression line is <span class="math inline">\(y_i = \beta x_i + \beta_0 + \epsilon\)</span>. In order to adding the outliers, we sample the index of all data point and select 10% percentage of all points as outliers. Huge variation was added to the line to mimic the outliers caused by measurement error et al. The huge variation from another normal distribution which is <span class="math inline">\(\eta \sim N(0,2^2)\)</span>.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="co"># set the seed for randomization</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">12345</span>)
<span class="no">gene</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="kw">n</span><span class="kw">=</span><span class="fl">300</span>, <span class="kw">mean</span><span class="kw">=</span><span class="fl">5</span>, <span class="kw">sd</span><span class="kw">=</span><span class="fl">1</span>)
<span class="no">inter</span> <span class="kw">=</span> <span class="fl">1</span> ; <span class="no">slope</span> <span class="kw">=</span> <span class="fl">0.8</span>
<span class="no">outcome</span> <span class="kw">=</span> <span class="no">slope</span> * <span class="no">gene</span> + <span class="no">inter</span>
<span class="no">outcome</span> <span class="kw">=</span> <span class="no">outcome</span> + <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="kw">n</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">outcome</span>),<span class="kw">mean</span><span class="kw">=</span><span class="fl">0</span>, <span class="kw">sd</span><span class="kw">=</span><span class="fl">0.3</span>)
<span class="co"># add the outliers</span>
<span class="co"># 10% of variable should be outliers, user can customize the percentage</span>
<span class="no">id_outlier</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">outcome</span>), <span class="kw">size</span> <span class="kw">=</span> <span class="fl">0.1</span>*<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">outcome</span>))
<span class="no">outcome</span>[<span class="no">id_outlier</span>] <span class="kw">=</span> <span class="no">outcome</span>[<span class="no">id_outlier</span>] + <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">id_outlier</span>), <span class="kw">mean</span><span class="kw">=</span><span class="fl">0</span>,<span class="kw">sd</span><span class="kw">=</span><span class="fl">2</span>)</pre></body></html></div>
<p>All methods mentioned in the paper were integrated in the package in a very user-freindly way. If the user want to perform the robust regression in example 1. The user can run the Least Trimmed Saured Robust Regression by just calling <em>MLM</em> main function and setting the <em>ml.method</em> parameter as ‘a’.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">res.a</span> <span class="kw">=</span> <span class="fu"><a href="../reference/MLM.html">MLM</a></span>(<span class="kw">ml.method</span><span class="kw">=</span><span class="st">'a'</span>, <span class="no">outcome</span>, <span class="no">gene</span>)</pre></body></html></div>
<p>Once we get the result from the method 1, we can extract the sample information that which sample should be a outlier or not.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">inds_out</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="no">res.a</span>$<span class="no">lts.wt</span> <span class="kw">==</span> <span class="fl">0</span>)
<span class="co">#print the data id which is outlier.</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">inds_out</span>)</pre></body></html></div>
<pre><code>##  [1]  14  16  23  43  46  49  69  91  96 101 131 144 198 205 215 226 276 278 282
## [20] 283 290</code></pre>
<p>The RobMixReg package has a plotting module for visualization in a easy way. For the example 1, we draw all data point and color them based on whether it is a outlier. Then, we also print another figure which contains the fitted regression line and metric (coeffient and related significant p value).</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="no">inds_in</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="no">res.a</span>$<span class="no">lts.wt</span> <span class="kw">==</span> <span class="fl">1</span>)
<span class="co"># set the figure format and margin</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mfrow</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">1</span>),<span class="kw">mar</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">5</span>, <span class="fl">8</span>, <span class="fl">2</span>, <span class="fl">8</span>))
<span class="co"># use plot module to draw the data points and the regression line.</span>
<span class="fu"><a href="../reference/plot_CTLE-methods.html">plot_CTLE</a></span>(<span class="no">outcome</span>~<span class="no">gene</span>,<span class="kw">data</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="no">gene</span>,<span class="no">outcome</span>),<span class="kw">nc</span><span class="kw">=</span><span class="fl">1</span>,<span class="kw">inds_in</span><span class="kw">=</span><span class="no">inds_in</span>)</pre></body></html></div>
<p><img src="tutorial_files/figure-html/unnamed-chunk-6-1.png" width="700"><img src="tutorial_files/figure-html/unnamed-chunk-6-2.png" width="700"></p>
</div>
</div>
<div id="s2-2-example-2-low-dimension-k2-without-outlier" class="section level3">
<h3 class="hasAnchor">
<a href="#s2-2-example-2-low-dimension-k2-without-outlier" class="anchor"></a>S2.2 Example 2: Low dimension, <span class="math inline">\(K=2\)</span> without outlier</h3>
<p>The relationship between gene expression and patient outcome is complex. Besides the outlier problem, the heterogeneity among the subject is also a challenge. Due to subgroup patient may behave similar property. Mixture model (e.g. mixture regression line) were widely used in real application. However, to the best of our knowledge, there is no package provide a flexible mixture regression modeling expet the ‘mixtureReg’ (see maintext reference). The RobMixReg package modified and optimized the several functions in ‘mixtureReg’ which meet the publish requirement of CRAN.</p>
<ul>
<li>Mathmatical Model</li>
</ul>
<p><span class="math display">\[
y_i = \beta_k x_i + \beta_{k0} + \epsilon_{ki},
\]</span> where <span class="math display">\[
\epsilon_{ki} \sim N(0,\sigma_k^2),k=1,2; i=1,...,n.
\]</span></p>
<div id="data-simulation-1" class="section level4">
<h4 class="hasAnchor">
<a href="#data-simulation-1" class="anchor"></a>Data Simulation:</h4>
<p>To demonstrate flexible mixture regression model, we simulated two lines through below script. The user can change the two coefficient parameter by setting the <em>slope1</em> and <em>slope2</em>. Also, two intercepts controlled by <em>inter1</em> and <em>inter2</em>. The Gaussian white noisy added to two lines form a normal distribution as <span class="math inline">\(\epsilon_{ki} \sim N(0,0,1^2)\)</span>. For giving a balanced number of mixture model, we selected odd position data points as the first regression line and even position data point as the second regression line.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="no">gene</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="kw">n</span><span class="kw">=</span><span class="fl">300</span>, <span class="kw">mean</span><span class="kw">=</span><span class="fl">5</span>, <span class="kw">sd</span><span class="kw">=</span><span class="fl">1</span>)
<span class="no">outcome</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">gene</span>))
<span class="no">slope1</span> <span class="kw">=</span> <span class="fl">0.8</span>; <span class="no">inter1</span> <span class="kw">=</span> <span class="fl">0.2</span>; <span class="no">slope2</span> <span class="kw">=</span> -<span class="fl">0.01</span>; <span class="no">inter2</span> <span class="kw">=</span> <span class="fl">4</span>
<span class="no">n</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">gene</span>)
<span class="no">outcome</span>[<span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="no">n</span>) <span class="kw">%%</span> <span class="fl">2</span> <span class="kw">==</span> <span class="fl">1</span>] <span class="kw">=</span> <span class="no">slope1</span> * <span class="no">gene</span>[<span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="no">n</span>) <span class="kw">%%</span> <span class="fl">2</span> <span class="kw">==</span> <span class="fl">1</span>] + <span class="no">inter1</span>
<span class="no">outcome</span>[<span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="no">n</span>) <span class="kw">%%</span> <span class="fl">2</span> <span class="kw">==</span> <span class="fl">1</span>] <span class="kw">=</span> <span class="no">outcome</span>[<span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="no">n</span>) <span class="kw">%%</span> <span class="fl">2</span> <span class="kw">==</span> <span class="fl">1</span>] + <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">outcome</span>)/<span class="fl">2</span>,<span class="kw">mean</span><span class="kw">=</span><span class="fl">0</span>,<span class="kw">sd</span><span class="kw">=</span><span class="fl">0.1</span>)
<span class="no">outcome</span>[<span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="no">n</span>) <span class="kw">%%</span> <span class="fl">2</span> <span class="kw">==</span> <span class="fl">0</span>] <span class="kw">=</span> <span class="no">slope2</span> * <span class="no">gene</span>[<span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="no">n</span>) <span class="kw">%%</span> <span class="fl">2</span> <span class="kw">==</span> <span class="fl">0</span>] + <span class="no">inter2</span>
<span class="no">outcome</span>[<span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="no">n</span>) <span class="kw">%%</span> <span class="fl">2</span> <span class="kw">==</span> <span class="fl">0</span>] <span class="kw">=</span> <span class="no">outcome</span>[<span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="no">n</span>) <span class="kw">%%</span> <span class="fl">2</span> <span class="kw">==</span> <span class="fl">0</span>] + <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">outcome</span>)/<span class="fl">2</span>,<span class="kw">mean</span><span class="kw">=</span><span class="fl">0</span>,<span class="kw">sd</span><span class="kw">=</span><span class="fl">0.1</span>)</pre></body></html></div>
<p>The package own the capability of fitting flexible mixture regression. User can customize the several regression format by setting the <em>b.formulaList</em> parameter.</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="no">res.b</span> <span class="kw">=</span> <span class="fu"><a href="../reference/MLM.html">MLM</a></span>(<span class="kw">ml.method</span><span class="kw">=</span><span class="st">'b'</span>, <span class="no">gene</span>, <span class="no">outcome</span>,
            <span class="kw">b.formulaList</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/formula.html">formula</a></span>(<span class="no">outcome</span> ~ <span class="no">gene</span>),<span class="fu"><a href="https://rdrr.io/r/stats/formula.html">formula</a></span>(<span class="no">outcome</span> ~ <span class="fl">1</span>)))</pre></body></html></div>
<pre><code>## diff =  -3.691596e-09 
## iter =  14 
## restart =  0 
## log-likelihood =  90.17514</code></pre>
<p>The plot function provide the two modules for the example 2. The first modele will draw two mixture regression lines with different color.</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mar</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">5</span>, <span class="fl">8</span>, <span class="fl">2</span>, <span class="fl">8</span>))
<span class="fu"><a href="../reference/plot_mixtureReg.html">plot_mixtureReg</a></span>(<span class="no">res.b</span>, <span class="kw">which</span> <span class="kw">=</span> <span class="fl">1</span>)</pre></body></html></div>
<p><img src="tutorial_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<p>The second module give the posterior for each data point. The pposterior decide which data point belong to which regression line in mixture model. In both figures, some data points around 5 have low prior because the intersection point is around 5 show as the last figure. It means it is difficult to cluster the point near the intersection point of two lines.</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mfrow</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">2</span>))
<span class="fu"><a href="../reference/plot_mixtureReg.html">plot_mixtureReg</a></span>(<span class="no">res.b</span>, <span class="kw">which</span> <span class="kw">=</span> <span class="fl">2</span>)</pre></body></html></div>
<p><img src="tutorial_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
</div>
</div>
<div id="s2-3-example-3-low-dimension-k2-with-outlier" class="section level3">
<h3 class="hasAnchor">
<a href="#s2-3-example-3-low-dimension-k2-with-outlier" class="anchor"></a>S2.3 Example 3: Low dimension, <span class="math inline">\(K=2\)</span> with outlier</h3>
<p>As described in last two examples, we explorer the outlier and heterogeneity among the patient. In this example 3, we will demonstrate using our in-house algorithm CAT to detect the outlier and estimate the parameter of mixture model simultaneously.</p>
<ul>
<li>Mathmatical Model</li>
</ul>
<p><span class="math display">\[
\left\{ \begin{array}{rcl}
  y_i - \beta_k x_i - \beta_{k0} - \epsilon_{ki} \leq \eta &amp; \mbox{if} &amp; (x_i, y_i) \in regression \ line \\ 
  y_i - \beta_k x_i - \beta_{k0} - \epsilon_{ki} \leq \eta &amp; \mbox{if} &amp; (x_i, y_i) \ is \ outlier \\
  \end{array}\right.
\]</span></p>
<div id="data-simulation-2" class="section level4">
<h4 class="hasAnchor">
<a href="#data-simulation-2" class="anchor"></a>Data Simulation:</h4>
<p>The simulation of example 3 combines the process of example 1 and example 2. Two regression lines can be customized by setting the coefficient and intercept parameter. The outliers were selected randomly and the number of outlier is controlled by parameter <em>size</em>.</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">12345</span>)
<span class="no">gene</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="kw">n</span><span class="kw">=</span><span class="fl">300</span>, <span class="kw">mean</span><span class="kw">=</span><span class="fl">5</span>, <span class="kw">sd</span><span class="kw">=</span><span class="fl">1</span>)
<span class="no">outcome</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">gene</span>))
<span class="no">slope1</span> <span class="kw">=</span> <span class="fl">0.8</span>; <span class="no">inter1</span> <span class="kw">=</span> <span class="fl">0.2</span>; <span class="no">slope2</span> <span class="kw">=</span> -<span class="fl">0.6</span>; <span class="no">inter2</span> <span class="kw">=</span> <span class="fl">7</span>
<span class="no">n</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">gene</span>)
<span class="no">outcome</span>[<span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="no">n</span>) <span class="kw">%%</span> <span class="fl">2</span> <span class="kw">==</span> <span class="fl">1</span>] <span class="kw">=</span> <span class="no">slope1</span> * <span class="no">gene</span>[<span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="no">n</span>) <span class="kw">%%</span> <span class="fl">2</span> <span class="kw">==</span> <span class="fl">1</span>] + <span class="no">inter1</span>
<span class="no">outcome</span>[<span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="no">n</span>) <span class="kw">%%</span> <span class="fl">2</span> <span class="kw">==</span> <span class="fl">1</span>] <span class="kw">=</span> <span class="no">outcome</span>[<span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="no">n</span>) <span class="kw">%%</span> <span class="fl">2</span> <span class="kw">==</span> <span class="fl">1</span>] + <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">outcome</span>)/<span class="fl">2</span>,<span class="kw">mean</span><span class="kw">=</span><span class="fl">0</span>,<span class="kw">sd</span><span class="kw">=</span><span class="fl">0.1</span>)
<span class="no">outcome</span>[<span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="no">n</span>) <span class="kw">%%</span> <span class="fl">2</span> <span class="kw">==</span> <span class="fl">0</span>] <span class="kw">=</span> <span class="no">slope2</span> * <span class="no">gene</span>[<span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="no">n</span>) <span class="kw">%%</span> <span class="fl">2</span> <span class="kw">==</span> <span class="fl">0</span>] + <span class="no">inter2</span>
<span class="no">outcome</span>[<span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="no">n</span>) <span class="kw">%%</span> <span class="fl">2</span> <span class="kw">==</span> <span class="fl">0</span>] <span class="kw">=</span> <span class="no">outcome</span>[<span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="no">n</span>) <span class="kw">%%</span> <span class="fl">2</span> <span class="kw">==</span> <span class="fl">0</span>] + <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">outcome</span>)/<span class="fl">2</span>,<span class="kw">mean</span><span class="kw">=</span><span class="fl">0</span>,<span class="kw">sd</span><span class="kw">=</span><span class="fl">0.1</span>)
<span class="co"># The size parameter control the number of outliers during simulation.</span>
<span class="no">id_outlier</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">outcome</span>), <span class="kw">size</span> <span class="kw">=</span> <span class="fl">10</span>)
<span class="no">outcome</span>[<span class="no">id_outlier</span>] <span class="kw">=</span> <span class="no">outcome</span>[<span class="no">id_outlier</span>] + <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">id_outlier</span>), <span class="kw">mean</span><span class="kw">=</span><span class="fl">0</span>,<span class="kw">sd</span><span class="kw">=</span><span class="fl">2</span>)</pre></body></html></div>
<p>Run the Component-wise Adaptive Trimming method to detect outlier and estimate the parameter simultaneously.</p>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="no">res.c</span> <span class="kw">=</span> <span class="fu"><a href="../reference/MLM.html">MLM</a></span>(<span class="kw">ml.method</span><span class="kw">=</span><span class="st">"c"</span>, <span class="no">gene</span>, <span class="no">outcome</span>)</pre></body></html></div>
<p>Extract the outlier information and plot the mixture regression line one by one.</p>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="no">inds_in</span><span class="kw">=</span><span class="no">res.c</span>@<span class="kw">inds_in</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mfrow</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">1</span>),<span class="kw">mar</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">5</span>, <span class="fl">8</span>, <span class="fl">2</span>, <span class="fl">8</span>))
<span class="fu"><a href="../reference/plot_CTLE-methods.html">plot_CTLE</a></span>(<span class="no">outcome</span>~<span class="no">gene</span>,<span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="no">gene</span>,<span class="no">outcome</span>),<span class="kw">nc</span><span class="kw">=</span><span class="fl">2</span>,<span class="kw">inds_in</span><span class="kw">=</span><span class="no">inds_in</span>)</pre></body></html></div>
<p><img src="tutorial_files/figure-html/unnamed-chunk-13-1.png" width="700"><img src="tutorial_files/figure-html/unnamed-chunk-13-2.png" width="700"><img src="tutorial_files/figure-html/unnamed-chunk-13-3.png" width="700"></p>
</div>
</div>
<div id="s2-4-example-4-high-dimension-k2" class="section level3">
<h3 class="hasAnchor">
<a href="#s2-4-example-4-high-dimension-k2" class="anchor"></a>S2.4 Example 4: High dimension, <span class="math inline">\(K=2\)</span>
</h3>
<p>The gene expression data is usually in high dimension. Only modeling the relationship between two vectors is not enough. For example, alternatively actived genes or pathways in different patient subpopulation subtantially hurdled the computational capability in studying the disease complexities and optimizing therapeutic strategy, which is fundamental question in precision health study. The set of genes used to execute a biological pathway of clinical response may very likely exist in more than one alternative form, thus lead to patient subpopulation exhibiting varied level of sensitivity and clinical response different cytotoxic drugs, posing a challenge in identifying gene features that are predictive for clinical response to existing but unknown patient subpopulation. Thus, we proposed the RBSL algorithm, following the supervised methods, to enable the identification of subsets genes. The detailed motivation and algorithm please refer to the RBSL paper.</p>
<ul>
<li>Mathmatical Model</li>
</ul>
<p><span class="math display">\[
argmin || y_{J_K} - X^T_{:,J_k} \beta_k - \beta_{k0} ||,s.t. ||\beta_k || \leq \lambda_k
\]</span></p>
<div id="data-simulation-3" class="section level4">
<h4 class="hasAnchor">
<a href="#data-simulation-3" class="anchor"></a>Data Simulation:</h4>
<p>In total, we simulate a matrix which is 400 patients by 100 genes. The first twenty genes contributed to the first 200 patients. The continued twenty genes contributed to the last 200 patients. The simulation process is simply executed by a function <em>simu_data_sparse</em>, please see the package manual for more details.</p>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="no">n</span><span class="kw">=</span><span class="fl">400</span>
<span class="no">bet1</span><span class="kw">=</span><span class="no">bet2</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0</span>,<span class="fl">101</span>)
<span class="no">bet1</span>[<span class="fl">2</span>:<span class="fl">21</span>]<span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/sign.html">sign</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span>(<span class="fl">20</span>,-<span class="fl">1</span>,<span class="fl">1</span>))*<span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span>(<span class="fl">20</span>,<span class="fl">2</span>,<span class="fl">5</span>)
<span class="no">bet2</span>[<span class="fl">22</span>:<span class="fl">41</span>]<span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/sign.html">sign</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span>(<span class="fl">20</span>,-<span class="fl">1</span>,<span class="fl">1</span>))*<span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span>(<span class="fl">20</span>,<span class="fl">2</span>,<span class="fl">5</span>)
<span class="no">bet</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span>(<span class="no">bet1</span>,<span class="no">bet2</span>)
<span class="no">pr</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">1</span>)*<span class="fl">0.5</span>
<span class="no">sigs</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">1</span>)<span class="co">####need to loop through 0.5, 1, 2</span>
<span class="no">tmp_list</span> <span class="kw">=</span> <span class="fu"><a href="../reference/simu_data_sparse.html">simu_data_sparse</a></span>(<span class="kw">n</span><span class="kw">=</span><span class="no">n</span>,<span class="kw">bet</span><span class="kw">=</span><span class="no">bet</span>,<span class="kw">pr</span><span class="kw">=</span><span class="no">pr</span>,<span class="kw">sigma</span><span class="kw">=</span><span class="no">sigs</span>)
<span class="no">nit</span><span class="kw">=</span><span class="fl">1</span>
<span class="no">nc</span><span class="kw">=</span><span class="fl">2</span>
<span class="no">max_iter</span><span class="kw">=</span><span class="fl">50</span>
<span class="no">x</span><span class="kw">=</span><span class="no">tmp_list</span>$<span class="no">x</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="st">"Dimension of matrix (x):"</span>);<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span>(<span class="no">x</span>)</pre></body></html></div>
<pre><code>## [1] "Dimension of matrix (x):"</code></pre>
<pre><code>## [1] 400 100</code></pre>
<div class="sourceCode" id="cb19"><html><body><pre class="r"><span class="no">y</span><span class="kw">=</span><span class="no">tmp_list</span>$<span class="no">y</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="st">"Length of outcome variable (y):"</span>); <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">y</span>)</pre></body></html></div>
<pre><code>## [1] "Length of outcome variable (y):"</code></pre>
<pre><code>## [1] 400</code></pre>
<p>Run the RBSL method to identify the subspaces on which subsets of genes are explainable to the patient outcome variable. The parameter <em>x</em> is a high dimensional matrix and parameter <em>y</em> is the patient outcome variable.</p>
<div class="sourceCode" id="cb22"><html><body><pre class="r"><span class="no">res.d</span> <span class="kw">=</span> <span class="fu"><a href="../reference/MLM.html">MLM</a></span>(<span class="kw">ml.method</span> <span class="kw">=</span> <span class="st">'d'</span>,<span class="kw">x</span><span class="kw">=</span><span class="no">x</span>,<span class="kw">y</span><span class="kw">=</span><span class="no">y</span>)
<span class="co"># The result of the RBSL algorithm consist of 5 objects.</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">res.d</span>)</pre></body></html></div>
<pre><code>## [1] "coffs" "clus"  "x"     "y"     "yhat"</code></pre>
<p>Plot the predicted coefficient matrix. The column is the cluster membership and the row is the each cluster’s coefficient value of genes.</p>
<div class="sourceCode" id="cb24"><html><body><pre class="r"><span class="co">#par(mfrow=c(1,1),mar = c(0.1, 0.1, 0.1, 0.1))</span>
<span class="fu"><a href="../reference/blockMap.html">blockMap</a></span>(<span class="no">res.d</span>)</pre></body></html></div>
<p><img src="tutorial_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
</div>
</div>
</div>
<div id="s3--real-data-application" class="section level2">
<h2 class="hasAnchor">
<a href="#s3--real-data-application" class="anchor"></a>S3. Real Data Application</h2>
<p>Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder</p>
<div id="s3-1-breast-cancer-multi-omics-data-filtered-outlier-mutually" class="section level3">
<h3 class="hasAnchor">
<a href="#s3-1-breast-cancer-multi-omics-data-filtered-outlier-mutually" class="anchor"></a>S3.1 Breast Cancer Multi-Omics Data Filtered Outlier Mutually</h3>
<p>Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder</p>
<p>How we extract information from RNA-seq and ATAC-seq data.</p>
<div class="sourceCode" id="cb25"><html><body><pre class="r"><span class="co"># read the list object built-in the package</span>
<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">'BRCA_source'</span>)</pre></body></html></div>
<pre><code>## [[1]]
## [1] "BRCA_source"</code></pre>
<div class="sourceCode" id="cb27"><html><body><pre class="r"><span class="no">data_RNAseq_selected</span> <span class="kw">=</span> <span class="no">BRCA_source</span>$<span class="no">data_RNAseq_selected</span>
<span class="no">data_ATACseq_selected</span> <span class="kw">=</span> <span class="no">BRCA_source</span>$<span class="no">data_ATACseq_selected</span>
<span class="no">RNAseq_marker</span> <span class="kw">=</span> <span class="no">BRCA_source</span>$<span class="no">RNAseq_marker</span>
<span class="no">ATACseq_marker</span> <span class="kw">=</span> <span class="no">BRCA_source</span>$<span class="no">ATACseq_marker</span>

<span class="no">b4_TCGA</span><span class="kw">&lt;-</span><span class="fu"><a href="../reference/Compute_Rbase_SVD.html">Compute_Rbase_SVD</a></span>(<span class="no">data_RNAseq_selected</span>,<span class="no">RNAseq_marker</span>)
<span class="no">b4_ATAC0</span><span class="kw">&lt;-</span><span class="fu"><a href="../reference/Compute_Rbase_SVD.html">Compute_Rbase_SVD</a></span>(<span class="no">data_ATACseq_selected</span>,<span class="no">ATACseq_marker</span>)
<span class="co"># generate the RNA-seq and ATAC-seq variable below.</span>
<span class="no">a1</span><span class="kw">&lt;-</span><span class="no">b4_TCGA</span>[<span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">b4_ATAC0</span>)]
<span class="no">b1</span><span class="kw">&lt;-</span><span class="no">b4_ATAC0</span>[<span class="fl">1</span>,]
<span class="no">a2</span><span class="kw">&lt;-</span><span class="no">b4_TCGA</span>[<span class="fl">2</span>,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">b4_ATAC0</span>)]
<span class="no">b2</span><span class="kw">&lt;-</span><span class="no">b4_ATAC0</span>[<span class="fl">2</span>,]
<span class="no">a3</span><span class="kw">&lt;-</span><span class="no">b4_TCGA</span>[<span class="fl">3</span>,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">b4_ATAC0</span>)]
<span class="no">b3</span><span class="kw">&lt;-</span><span class="no">b4_ATAC0</span>[<span class="fl">3</span>,]</pre></body></html></div>
<p>These variables also provide in another data frame object.</p>
<div class="sourceCode" id="cb28"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">BRCA_ATAC_RNA_seq</span>)
<span class="co"># First, extract the RNA-seq vectors</span>
<span class="no">a1</span> <span class="kw">=</span> <span class="no">BRCA_ATAC_RNA_seq</span>$<span class="no">a1</span>
<span class="no">a2</span> <span class="kw">=</span> <span class="no">BRCA_ATAC_RNA_seq</span>$<span class="no">a2</span>
<span class="no">a3</span> <span class="kw">=</span> <span class="no">BRCA_ATAC_RNA_seq</span>$<span class="no">a3</span>
<span class="co"># Second, extract the ATAC-seq vectors</span>
<span class="no">b1</span> <span class="kw">=</span> <span class="no">BRCA_ATAC_RNA_seq</span>$<span class="no">b1</span>
<span class="no">b2</span> <span class="kw">=</span> <span class="no">BRCA_ATAC_RNA_seq</span>$<span class="no">b2</span>
<span class="no">b3</span> <span class="kw">=</span> <span class="no">BRCA_ATAC_RNA_seq</span>$<span class="no">b3</span></pre></body></html></div>
<p>Call the main function to detect the outliers.</p>
<div class="sourceCode" id="cb29"><html><body><pre class="r"><span class="no">brca.1</span> <span class="kw">=</span> <span class="fu"><a href="../reference/MLM.html">MLM</a></span>(<span class="kw">ml.method</span><span class="kw">=</span><span class="st">'c'</span>, <span class="kw">gene</span><span class="kw">=</span><span class="no">a1</span>, <span class="kw">outcome</span><span class="kw">=</span><span class="no">b1</span>,<span class="kw">nit</span><span class="kw">=</span><span class="fl">10</span>,<span class="kw">nc</span><span class="kw">=</span><span class="fl">1</span>)
<span class="no">brca.2</span> <span class="kw">=</span> <span class="fu"><a href="../reference/MLM.html">MLM</a></span>(<span class="kw">ml.method</span><span class="kw">=</span><span class="st">'c'</span>, <span class="kw">gene</span><span class="kw">=</span><span class="no">a2</span>, <span class="kw">outcome</span><span class="kw">=</span><span class="no">b2</span>,<span class="kw">nit</span><span class="kw">=</span><span class="fl">10</span>,<span class="kw">nc</span><span class="kw">=</span><span class="fl">1</span>)
<span class="no">brca.3</span> <span class="kw">=</span> <span class="fu"><a href="../reference/MLM.html">MLM</a></span>(<span class="kw">ml.method</span><span class="kw">=</span><span class="st">'c'</span>, <span class="kw">gene</span><span class="kw">=</span><span class="no">a3</span>, <span class="kw">outcome</span><span class="kw">=</span><span class="no">b3</span>,<span class="kw">nit</span><span class="kw">=</span><span class="fl">10</span>,<span class="kw">nc</span><span class="kw">=</span><span class="fl">1</span>)</pre></body></html></div>
<p>Once we get the result from the method 1, we can extract the sample information that which sample should be a outlier or not.</p>
<div class="sourceCode" id="cb30"><html><body><pre class="r"><span class="no">inds_in</span> <span class="kw">=</span> <span class="no">brca.1</span>@<span class="kw">inds_in</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mfrow</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">2</span>),<span class="kw">mar</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">6</span>, <span class="fl">2</span>))
<span class="fu"><a href="../reference/plot_CTLE-methods.html">plot_CTLE</a></span>(<span class="no">b1</span>~<span class="no">a1</span>,<span class="kw">data</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="no">a1</span>,<span class="no">b1</span>),<span class="kw">nc</span><span class="kw">=</span><span class="fl">1</span>,<span class="kw">inds_in</span><span class="kw">=</span><span class="no">inds_in</span>)</pre></body></html></div>
<p><img src="tutorial_files/figure-html/unnamed-chunk-20-1.png" width="700"></p>
<div class="sourceCode" id="cb31"><html><body><pre class="r"><span class="no">inds_in</span> <span class="kw">=</span> <span class="no">brca.2</span>@<span class="kw">inds_in</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mfrow</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">2</span>),<span class="kw">mar</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">6</span>, <span class="fl">2</span>))
<span class="fu"><a href="../reference/plot_CTLE-methods.html">plot_CTLE</a></span>(<span class="no">b2</span>~<span class="no">a2</span>,<span class="kw">data</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="no">a2</span>,<span class="no">b2</span>),<span class="kw">nc</span><span class="kw">=</span><span class="fl">1</span>,<span class="kw">inds_in</span><span class="kw">=</span><span class="no">inds_in</span>)</pre></body></html></div>
<p><img src="tutorial_files/figure-html/unnamed-chunk-21-1.png" width="700"></p>
<div class="sourceCode" id="cb32"><html><body><pre class="r"><span class="no">inds_in</span> <span class="kw">=</span> <span class="no">brca.3</span>@<span class="kw">inds_in</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mfrow</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">2</span>),<span class="kw">mar</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">6</span>, <span class="fl">2</span>))
<span class="fu"><a href="../reference/plot_CTLE-methods.html">plot_CTLE</a></span>(<span class="no">b3</span>~<span class="no">a3</span>,<span class="kw">data</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="no">a3</span>,<span class="no">b3</span>),<span class="kw">nc</span><span class="kw">=</span><span class="fl">1</span>,<span class="kw">inds_in</span><span class="kw">=</span><span class="no">inds_in</span>)</pre></body></html></div>
<p><img src="tutorial_files/figure-html/unnamed-chunk-22-1.png" width="700"></p>
</div>
<div id="s3-2-cytokine-dataset" class="section level3">
<h3 class="hasAnchor">
<a href="#s3-2-cytokine-dataset" class="anchor"></a>S3.2 Cytokine Dataset</h3>
<p>Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder</p>
<p>Prepare the built-in cytokine data .</p>
<div class="sourceCode" id="cb33"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">Cytokine_dataset</span>)
<span class="co"># First, extract the two variable for IP10 gene</span>
<span class="no">IP10.Cytokine.level.C1D15</span> <span class="kw">=</span> <span class="no">Cytokine_dataset</span>$<span class="no">IP10.Cytokine.level.C1D15</span>
<span class="no">IP10.CPC.change</span> <span class="kw">=</span> <span class="no">Cytokine_dataset</span>$<span class="no">IP10.CPC.change</span>
<span class="co"># Second, extract the two variable for TNFa gene</span>
<span class="no">TNFa.Cytokine.level.C1D15</span> <span class="kw">=</span> <span class="no">Cytokine_dataset</span>$<span class="no">TNFa.Cytokine.level.C1D15</span>
<span class="no">TNFa.CPC.change</span> <span class="kw">=</span> <span class="no">Cytokine_dataset</span>$<span class="no">TNFa.CPC.change</span></pre></body></html></div>
<p>Then, call the main function to identify the outliers.</p>
<div class="sourceCode" id="cb34"><html><body><pre class="r"><span class="no">IP10.res</span> <span class="kw">=</span> <span class="fu"><a href="../reference/MLM.html">MLM</a></span>(<span class="kw">ml.method</span><span class="kw">=</span><span class="st">'c'</span>, <span class="kw">gene</span><span class="kw">=</span><span class="no">IP10.Cytokine.level.C1D15</span>, <span class="kw">outcome</span><span class="kw">=</span><span class="no">IP10.CPC.change</span>,<span class="kw">nit</span><span class="kw">=</span><span class="fl">10</span>,<span class="kw">nc</span><span class="kw">=</span><span class="fl">1</span>)
<span class="no">TNFa.res</span> <span class="kw">=</span> <span class="fu"><a href="../reference/MLM.html">MLM</a></span>(<span class="kw">ml.method</span><span class="kw">=</span><span class="st">'c'</span>, <span class="kw">gene</span><span class="kw">=</span><span class="no">TNFa.Cytokine.level.C1D15</span>, <span class="kw">outcome</span><span class="kw">=</span><span class="no">TNFa.CPC.change</span>,<span class="kw">nit</span><span class="kw">=</span><span class="fl">10</span>,<span class="kw">nc</span><span class="kw">=</span><span class="fl">1</span>)</pre></body></html></div>
<p>Once we get the result from the method 1, we can extract the sample information that which sample should be a outlier or not.</p>
<div class="sourceCode" id="cb35"><html><body><pre class="r"><span class="no">inds_in</span> <span class="kw">=</span> <span class="no">IP10.res</span>@<span class="kw">inds_in</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mfrow</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">2</span>),<span class="kw">mar</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">8</span>, <span class="fl">4</span>))
<span class="fu"><a href="../reference/plot_CTLE-methods.html">plot_CTLE</a></span>(<span class="no">IP10.CPC.change</span>~<span class="no">IP10.Cytokine.level.C1D15</span>,
          <span class="kw">data</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="no">IP10.Cytokine.level.C1D15</span>,<span class="no">IP10.CPC.change</span>),
          <span class="kw">nc</span><span class="kw">=</span><span class="fl">1</span>,<span class="kw">inds_in</span><span class="kw">=</span><span class="no">inds_in</span>)</pre></body></html></div>
<p><img src="tutorial_files/figure-html/unnamed-chunk-25-1.png" width="700"></p>
<p>The coefficient is zero because we only take three digits after the decimal point. The approximate coefficient value shows below.</p>
<div class="sourceCode" id="cb36"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="no">IP10.CPC.change</span>~<span class="no">IP10.Cytokine.level.C1D15</span>)</pre></body></html></div>
<pre><code>## 
## Call:
## lm(formula = IP10.CPC.change ~ IP10.Cytokine.level.C1D15)
## 
## Coefficients:
##               (Intercept)  IP10.Cytokine.level.C1D15  
##                 0.0670508                  0.0000258</code></pre>
<p>Once we get the result from the method 1, we can extract the sample information that which sample should be a outlier or not.</p>
<div class="sourceCode" id="cb38"><html><body><pre class="r"><span class="no">inds_in</span> <span class="kw">=</span> <span class="no">TNFa.res</span>@<span class="kw">inds_in</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mfrow</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">2</span>),<span class="kw">mar</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">8</span>, <span class="fl">4</span>))
<span class="fu"><a href="../reference/plot_CTLE-methods.html">plot_CTLE</a></span>(<span class="no">TNFa.CPC.change</span>~<span class="no">TNFa.Cytokine.level.C1D15</span>,
          <span class="kw">data</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="no">TNFa.Cytokine.level.C1D15</span>,<span class="no">TNFa.CPC.change</span>),
          <span class="kw">nc</span><span class="kw">=</span><span class="fl">1</span>,<span class="kw">inds_in</span><span class="kw">=</span><span class="no">inds_in</span>)</pre></body></html></div>
<p><img src="tutorial_files/figure-html/unnamed-chunk-27-1.png" width="700"></p>
</div>
</div>
<div id="s4--integrated-robust-mixture-regression-algorithms-and-example" class="section level2">
<h2 class="hasAnchor">
<a href="#s4--integrated-robust-mixture-regression-algorithms-and-example" class="anchor"></a>S4. Integrated Robust Mixture Regression Algorithms and Example</h2>
<div id="s4-1-robust-mixture-regression-algorithms" class="section level3">
<h3 class="hasAnchor">
<a href="#s4-1-robust-mixture-regression-algorithms" class="anchor"></a>S4.1 Robust Mixture Regression Algorithms</h3>
<p>Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder Place holder</p>
</div>
<div id="s4-2-example" class="section level3">
<h3 class="hasAnchor">
<a href="#s4-2-example" class="anchor"></a>S4.2 Example</h3>
<p>Another important main function in the package named <em>rmr</em> which provide five optional algorithms to fit the robust mixture regression model. The implemented algorithms includes: CTLERob stands for Component-wise adaptive Trimming Likelihood Estimation based mixture regression; mixbi stands for mixture regression based on bi-square estimation; mixLstands for mixture regression based on Laplacian distribution; TLE stands for Trimmed Likelihood Estimation based mixture regression. For more detail of the algorithms, please refer to references in the DESCRIPTION file.</p>
<p>User can select the algorithm by setting the parameter <em>lr.method</em>. One example is below. For description of <em>gaussData</em> please refer to package manual.</p>
<div class="sourceCode" id="cb39"><html><body><pre class="r"><span class="co"># gaussData</span>
<span class="no">x</span><span class="kw">=</span>(<span class="no">gaussData</span>$<span class="no">x</span>);<span class="no">y</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="no">gaussData</span>$<span class="no">y</span>);
<span class="no">formula01</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html">as.formula</a></span>(<span class="st">"y~x"</span>)
<span class="no">example_data01</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="no">x</span>,<span class="no">y</span>)
<span class="no">res_rmr</span> <span class="kw">=</span> <span class="fu"><a href="../reference/rmr.html">rmr</a></span>(<span class="kw">lr.method</span><span class="kw">=</span><span class="st">'flexmix'</span>, <span class="kw">formula</span><span class="kw">=</span><span class="no">formula01</span>, <span class="kw">data</span><span class="kw">=</span><span class="no">example_data01</span>)
<span class="no">res_rmr</span> <span class="kw">=</span> <span class="fu"><a href="../reference/rmr.html">rmr</a></span>(<span class="kw">lr.method</span><span class="kw">=</span><span class="st">'TLE'</span>, <span class="kw">formula</span><span class="kw">=</span><span class="no">formula01</span>, <span class="kw">data</span><span class="kw">=</span><span class="no">example_data01</span>)</pre></body></html></div>
</div>
<div id="s4-3-adjust-the-trimming-ratio-for-robust-regression" class="section level3">
<h3 class="hasAnchor">
<a href="#s4-3-adjust-the-trimming-ratio-for-robust-regression" class="anchor"></a>S4.3 Adjust the trimming ratio for robust regression</h3>
<div class="sourceCode" id="cb40"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">12345</span>)
<span class="no">gene</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="kw">n</span><span class="kw">=</span><span class="fl">300</span>, <span class="kw">mean</span><span class="kw">=</span><span class="fl">5</span>, <span class="kw">sd</span><span class="kw">=</span><span class="fl">1</span>)
<span class="no">inter</span> <span class="kw">=</span> <span class="fl">0</span> ; <span class="no">slope</span> <span class="kw">=</span> <span class="fl">1</span>
<span class="no">outcome</span> <span class="kw">=</span> <span class="no">slope</span> * <span class="no">gene</span> + <span class="no">inter</span>
<span class="no">outcome</span> <span class="kw">=</span> <span class="no">outcome</span> + <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="kw">n</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">outcome</span>),<span class="kw">mean</span><span class="kw">=</span><span class="fl">0</span>, <span class="kw">sd</span><span class="kw">=</span><span class="fl">0.3</span>)
<span class="no">id_outlier</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">outcome</span>), <span class="kw">size</span> <span class="kw">=</span> <span class="fl">0.1</span>*<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">outcome</span>))
<span class="no">outcome</span>[<span class="no">id_outlier</span>] <span class="kw">=</span> <span class="no">outcome</span>[<span class="no">id_outlier</span>] + <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">id_outlier</span>), <span class="kw">mean</span><span class="kw">=</span><span class="fl">0</span>,<span class="kw">sd</span><span class="kw">=</span><span class="fl">2</span>)

<span class="co"># gaussData</span>
<span class="co"># x=(gaussData$x);y=as.numeric(gaussData$y);</span>
<span class="co"># formula01=as.formula("y~x")</span>
<span class="co"># example_data01=data.frame(x,y)</span>

<span class="no">res_rmr_r1</span> <span class="kw">=</span> <span class="fu"><a href="../reference/rmr.html">rmr</a></span>(<span class="kw">lr.method</span><span class="kw">=</span><span class="st">'TLE'</span>, <span class="kw">formula</span><span class="kw">=</span><span class="no">outcome</span>~<span class="no">gene</span>, <span class="kw">data</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="no">outcome</span>,<span class="no">gene</span>),<span class="kw">nc</span><span class="kw">=</span><span class="fl">1</span>,
                 <span class="kw">tRatio</span><span class="kw">=</span><span class="fl">0.05</span>)
<span class="no">inds_in_r1</span> <span class="kw">=</span> <span class="no">res_rmr_r1</span>@<span class="kw">inds_in</span>

<span class="no">res_rmr_r2</span> <span class="kw">=</span> <span class="fu"><a href="../reference/rmr.html">rmr</a></span>(<span class="kw">lr.method</span><span class="kw">=</span><span class="st">'TLE'</span>, <span class="kw">formula</span><span class="kw">=</span><span class="no">outcome</span>~<span class="no">gene</span>, <span class="kw">data</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="no">outcome</span>,<span class="no">gene</span>),<span class="kw">nc</span><span class="kw">=</span><span class="fl">1</span>,
                 <span class="kw">tRatio</span><span class="kw">=</span><span class="fl">0.25</span>)
<span class="no">inds_in_r2</span> <span class="kw">=</span> <span class="no">res_rmr_r2</span>@<span class="kw">inds_in</span>

<span class="co"># set the figure format and margin</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mfrow</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>,<span class="fl">2</span>),<span class="kw">mar</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">4</span>))
<span class="co"># use plot module to draw the data points and the regression line.</span>
<span class="fu"><a href="../reference/plot_CTLE-methods.html">plot_CTLE</a></span>(<span class="no">outcome</span>~<span class="no">gene</span>,<span class="kw">data</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="no">outcome</span>,<span class="no">gene</span>),<span class="kw">nc</span><span class="kw">=</span><span class="fl">1</span>,<span class="kw">inds_in</span><span class="kw">=</span><span class="no">inds_in_r1</span>)
<span class="fu"><a href="../reference/plot_CTLE-methods.html">plot_CTLE</a></span>(<span class="no">outcome</span>~<span class="no">gene</span>,<span class="kw">data</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="no">outcome</span>,<span class="no">gene</span>),<span class="kw">nc</span><span class="kw">=</span><span class="fl">1</span>,<span class="kw">inds_in</span><span class="kw">=</span><span class="no">inds_in_r2</span>)</pre></body></html></div>
<p><img src="tutorial_files/figure-html/unnamed-chunk-29-1.png" width="700"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Sha Cao, Wennan Chang, Chi Zhang.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
